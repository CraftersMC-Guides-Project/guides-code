<div class="sidebar-top">
   <div class="sidebar-top-top">
      <img id="sidebarProfilePic" src="../assets/cmc-guides.png" alt="CMC Guides Logo">
   </div>
   <div id="sidebar-name">CraftersMc Guide</div>
   <div class="sidebar-top-bottom">
    <div class="sidebar-top-bottom-top">
     <div style="display: flex; flex-direction: row; justify-content: center; align-items: center;">
      <div id="sidebarAvatar" style="width: 30px; height: 30px; border-radius: 50%; overflow: hidden; margin-right: 5px;">
        <img id="sidebarAvatarImg" src="" alt="Discord Avatar" style="width: 100%; height: 100%; object-fit: cover;">
      </div>
     <p id="sidebarName" style="text-align: initial; font-size: 1rem; width: 126px; margin-left: 5px;"></p>
   </div>
     <div id="settings" style="padding: 0; margin: 0; text-align: unset; height: 39px; width: 50px; display: inline-flex; align-items: center; justify-content: center;">
  <span class="menu-icon material-icons" style="font-size: 38px;">settings</span>
</div>
   </div>
    <p id="sidebarUsername" style="text-align: initial; font-size: 14px; margin: 8px 10px 12px;"></p>
</div>
<hr>
<div class="sidebar-bottom">
   <div id="customConsole" style="background-color: #111; color: #0f0; font-size: 12px; padding: 10px; margin: 10px; height: 150px; overflow-y: auto; display: none;">
  <b>Console Output:</b><br>
   </div>

<a class="sidebar-link" href="../rank-sellers.html">Rank Sellers</a>
<a class="sidebar-link" href="../unicode.html">Unicode</a>
<a class="sidebar-link" href="../journey-guides.html">Guides</a>
<a class="sidebar-link" href="../event-log.html">Events</a>
<a class="sidebar-link" href="../leaderboards.html">Collection Leaderboards</a>
<a class="sidebar-link" href="https://craftersmc.wiki.gg/wiki/">CraftersMC Wiki</a>
<a class="sidebar-link" href="https://craftersmc.net/">CraftersMC Website</a>
</div>

         <script>
document.addEventListener("DOMContentLoaded", () => {
    const profileImg = document.getElementById("sidebarProfilePic");
    const usernameText = document.getElementById("sidebarUsername");
    const sidebarNameElement = document.getElementById("sidebarName");
    const sidebarAvatarElement = document.getElementById("sidebarAvatar");
    const sidebarAvatarImgElement = document.getElementById("sidebarAvatarImg");

    try {
        const storedUser = localStorage.getItem("discordUser");
        if (storedUser) {
            const userData = JSON.parse(storedUser);
            console.log("Retrieved user data from localStorage:", userData); // Debugging

            //Set CMC guides logo
            profileImg.src = "../assets/cmc-guides.png";

            usernameText.textContent = `${userData.username}#${userData.discriminator}`;
            sidebarNameElement.innerHTML = userData.username;

            console.log("Checking userData.rank:", userData.rank); // Forcefully log the rank

            if (userData.rank) {
                console.log("User rank found (inside if):", userData.rank); // Debugging rank value
                const tag = document.createElement("span");
                tag.textContent = userData.rank.toUpperCase(); // Ensure consistent casing
                const lowerCaseRank = userData.rank.toLowerCase(); // For case-insensitive comparison

                if (lowerCaseRank === "coder") {
                    tag.style.backgroundColor = "#4caf50";
                } else if (lowerCaseRank === "data skimmer") {
                    tag.style.backgroundColor = "#2196f3";
                } else if (lowerCaseRank === "member") {
                    tag.style.backgroundColor = "#9e9e9e";
                } else {
                    tag.style.backgroundColor = "#555"; // Default background
                }

                tag.style.color = "white";
                tag.style.fontSize = "10px";
                tag.style.padding = "2px 6px";
                tag.style.borderRadius = "8px";
                tag.style.marginLeft = "6px";
                tag.style.textTransform = "uppercase";
                tag.style.fontWeight = "bold";
                tag.style.verticalAlign = "middle";
                tag.style.display = "inline-block";

                sidebarNameElement.appendChild(tag);
            } else {
                console.log("User rank is NOT truthy:", userData.rank); // Debugging no truthy rank
            }

            if (userData.avatar) {
                const avatarUrl = `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png`;
                sidebarAvatarElement.style.display = 'block';
                sidebarAvatarImgElement.src = avatarUrl;
            } else {
                sidebarAvatarElement.style.display = 'none';
            }

        } else {
            profileImg.src = "../assets/cmc-guides.png";
            usernameText.textContent = "";
            sidebarNameElement.textContent = "Name";
            sidebarAvatarElement.style.display = 'none';
        }
    } catch (error) {
        console.error("Error accessing localStorage or parsing user data:", error);
        profileImg.src = "../assets/cmc-guides.png";
        usernameText.textContent = "";
        sidebarNameElement.textContent = "Name";
        sidebarAvatarElement.style.display = 'none';
    }
});
         </script>
