<!DOCTYPE html>
<html>

<head>
  <title>Giveaway Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="themes/minecraft/style.css">
  <script src="js/script.js"></script>
  <style>
    /* Profile Card Styles */
    #top-right-ui-container {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 10px;
    }

    .profile-card {
      display: flex;
      align-items: center;
      gap: 10px;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 8px 12px;
      border-radius: 50px;
      color: white;
      text-decoration: none;
      transition: background-color 0.3s;
    }

    .profile-card:hover {
      background-color: rgba(0, 0, 0, 0.8);
    }

    .profile-card-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
    }

    .profile-card-name {
      font-weight: 500;
      font-size: 14px;
    }

    .dev-label {
      color: #ff4d4d;
      font-weight: bold;
      margin-left: 5px;
    }

    @media (max-width: 768px) {
      #top-right-ui-container {
        top: 65px;
        right: 10px;
        gap: 8px;
      }

      .profile-card {
        padding: 4px 8px;
      }

      .profile-card-avatar {
        width: 28px;
        height: 28px;
      }

      .profile-card-name {
        font-size: 12px;
      }
    }
  </style>
</head>

<body>
  <div id="loader">
    <div></div>
    <div></div>
    <div></div>
  </div>
  <div class="gw-detail-background"></div>

  <!-- Profile card container -->
  <div id="top-right-ui-container">
    <div id="profile-card-container"></div>
  </div>

  <div class="top"></div>
  <div class="sidebar" id="sidebar"></div>
  <div id="sidebar-overlay" onclick="toggleSidebar()"></div>
  <button id="float">
    <span class="material-icons" id="sweepBtn" style="background: #222; border-radius: 50px;">chevron_right</span>
    <span class="material-icons" id="homeBtn" onclick="homeBtn()">home</span>
    <span class="material-icons" id="ai" onclick="aiBtn()">smart_toy</span>
    <span class="material-icons" id="scrollToTopBtn">north</span>
  </button>
  <div class="gw-detail-giveaway-details-container">
    <div id="giveaway-content">Loading giveaway details...</div>
  </div>
  <div id="footer"></div>
  <script>
    // Add Profile Card Loader
    function getCookie(name) {
      return document.cookie.split('; ').reduce((r, v) => {
        const parts = v.split('=');
        return parts[0] === name ? decodeURIComponent(parts[1]) : r
      }, '');
    }

    async function loadProfileCard() {
      const storedUser = getCookie("discordUser");
      const profileContainer = document.getElementById("profile-card-container");

      let devIds = [];
      try {
        const response = await fetch('/devs.txt');
        if (response.ok) {
          const text = await response.text();
          devIds = text.split('\n').map(id => id.trim()).filter(id => id);
        }
      } catch (error) {
        console.error('Could not load or parse devs.txt:', error);
      }

      if (storedUser) {
        const user = JSON.parse(storedUser);
        const displayName = user.global_name || user.username;
        const isDevUser = devIds.includes(user.id);

        profileContainer.innerHTML = `
          <a href="/profile" class="profile-card">
            <img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png" alt="Avatar" class="profile-card-avatar">
            <span class="profile-card-name">
              ${displayName}
              ${isDevUser ? '<span class="dev-label">[DEV]</span>' : ''}
            </span>
          </a>
        `;
      } else {
        profileContainer.innerHTML = '';
      }
    }

    // Existing giveaway details JS remains unchanged
    function formatDateTime(dateStr) { /* unchanged code */ }
    function parseCustomDate(dateStr) { /* unchanged code */ }
    function getRoleTags(participant, currentSponsor, devIds) { /* unchanged code */ }
    async function loadGiveawayDetails() { /* unchanged code */ }
    function logout() { localStorage.removeItem('discordUser'); }
    function logoutAndRedirect() { logout(); window.location.href = 'login.html'; }
    function getFormattedNow() { /* unchanged code */ }
    function showParticipationModal() { /* unchanged code */ }

    // Run both profile card and giveaway details loader
    window.onload = () => {
      loadProfileCard();
      loadGiveawayDetails();
    }
  </script>
</body>

</html>
