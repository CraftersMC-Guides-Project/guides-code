<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <title>Best Reforge Calculator</title>
  <script src="js/script.js" defer></script>
  <script src="js/reforges.js"></script>
  <style>
* {
  -webkit-tap-highlight-color: transparent;
}
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #0d0d0d;
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 40px 20px;
  overflow-x: hidden;
  margin-bottom: 120px;
}
.container {
  width: 100%;
  max-width: 800px;
  background-color: #1a1a1a;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.6);
  padding: 20px;
  box-sizing: border-box;
  justify-content: center;
  margin: 0 auto;
}

h1 {
  text-align: center;
  margin-bottom: 20px;
  color: #3b82f6;
  width: 100%;
  font-size: 3rem;
}

p {
  text-align: center;
  padding: 20px 0px;
  color: white;
  width: 100%;
  margin: 0 auto;
}

.controls {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 15px;
  margin-bottom: 20px;
}

label {
  font-weight: 600;
  color: #fff;
}

select, button {
  padding: 8px 12px;
  border-radius: 6px;
  border: 1px solid #3b82f6;
  background-color: #0d0d0d;
  color: #fff;
  cursor: pointer;
  transition: all 0.2s;
}

select:disabled, button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

button {
  background-color: #3b82f6;
  border: none;
  font-weight: 600;
}

button:hover:not(:disabled) {
  background-color: #2563eb;
}

.rarity-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 15px;
}

.rarity-nav button {
  background-color: #1a1a1a;
  border: 1px solid #3b82f6;
  color: #3b82f6;
  font-size: 16px;
  padding: 5px 12px;
  border-radius: 6px;
}

.rarity-nav button:hover:not(:disabled) {
  background-color: #3b82f6;
  color: #fff;
}

.rarity-nav span {
  margin: 0 15px;
  font-weight: bold;
  color: #fff;
}

table {
  width: 100%;
  max-width: 100%;
  table-layout: fixed;
  word-wrap: break-word;
  border-collapse: collapse;
  margin-top: 10px;
  user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}

th, td {
  padding: 12px 8px;
  text-align: center;
  border-bottom: 1px solid #333;
}

thead th {
  background-color: #007bff;
  font-weight: 600;
  color: #fff;
}

tbody tr:hover {
  background-color: #222;
}

tbody tr:nth-child(1) td {
  background-color: #ffd700;
  font-weight: bold;
  color: #000;
}

tbody tr:nth-child(2) td {
  background-color: #c0c0c0;
  font-weight: bold;
  color: #000;
}

tbody tr:nth-child(3) td {
  background-color: #cd7f32;
  font-weight: bold;
  color: #000;
}

.reforge-name-wrapper {
  display: inline-block;
  position: relative;
}

.info-icon {
  position: absolute;
  top: -5px;
  right: -11px;
  background-color: #888;
  color: #fff;
  border-radius: 50%;
  width: 10px;
  height: 10px;
  font-size: 9px;
  line-height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  cursor: default;
  opacity: 0.8;
  z-index: 9;
  user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}

.info-popup {
  display: none;
  position: absolute;
  top: -5px;
  left: 210%;
  background-color: #1a1a1a;
  color: #fff;
  padding: 6px;
  border: 1px solid #888;
  border-radius: 6px;
  font-size: 0.8rem;
  white-space: nowrap;
  z-index: 10;
  user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}

.info-icon:hover .info-popup {
  display: block;
}
  </style>
</head>
<body>
    <div class="top"></div>
  <div class="sidebar" id="sidebar"></div>
  <div id="sidebar-overlay" onclick="toggleSidebar()"></div>

  <button id="float">
    <span class="material-icons" id="sweepBtn" style="background: #222; border-radius: 50px;">chevron_right</span>
    <span class="material-icons" id="homeBtn" onclick="homeBtn()">home</span>
    <span class="material-icons" id="ai" onclick="aiBtn()">smart_toy</span>
    <span class="material-icons" id="scrollToTopBtn">north</span>
  </button>
  <div class="gap"></div>
  <h1>Best Reforge Calculator</h1>
  <p>This calculator can sort out stats from highest to lowest. Select the item and stat you want on the item, and click on the calculate button. Use the ‚Üê and ‚Üí arrows to select the rarity of item!</p>
  <div class="container">
    <div class="controls">
      <label for="item">Choose Item:</label>
      <select id="item" class="skill-calc-input">
        <option value="" disabled selected hidden>No item selected</option>
        <option value="Sword">Sword</option>
        <option value="Armor">Armor</option>
        <option value="Axe">Axe</option>
        <option value="Hoe">Hoe</option>
        <option value="Accessory">Accessory</option>
        <option value="Bow">Bow</option>
        <option value="Boomerang">Boomerang</option>
      </select><label for="stat">Choose Stat:</label>
  <select id="stat" class="skill-calc-input">
    <option value="" disabled selected hidden>No stat selected</option>
  </select>

  <button id="calculateBtn" disabled>Calculate</button>
</div>

<div class="rarity-nav">
  <button id="prevRarity"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="m22.35 38.95-13.9-13.9q-.25-.25-.35-.5Q8 24.3 8 24q0-.3.1-.55.1-.25.35-.5L22.4 9q.4-.4 1-.4t1.05.45q.45.45.45 1.05 0 .6-.45 1.05L13.1 22.5h24.8q.65 0 1.075.425.425.425.425 1.075 0 .65-.425 1.075-.425.425-1.075.425H13.1l11.4 11.4q.4.4.4 1t-.45 1.05q-.45.45-1.05.45-.6 0-1.05-.45Z"/></svg></button>
  <span id="currentRarity"></span>
  <button id="nextRarity"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M22.95 38.9q-.4-.4-.4-1.05t.4-1.05l11.3-11.3H9.5q-.65 0-1.075-.425Q8 24.65 8 24q0-.65.425-1.075Q8.85 22.5 9.5 22.5h24.75l-11.3-11.3q-.4-.4-.4-1.075 0-.675.4-1.075.4-.4 1.05-.4t1.05.4l13.9 13.9q.25.25.35.5.1.25.1.55 0 .25-.1.525t-.35.525l-13.9 13.9q-.4.4-1.05.375-.65-.025-1.05-.425Z"/></svg></button>
</div>

<table id="resultsTable">
  <thead>
    <tr>
      <th>Rank</th>
      <th>Reforge</th>
      <th id="statHeader">Stat</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

  </div>
    <div class="index-footer">
    <div id="footer"></div><script>
const rarities = ["Common", "Uncommon", "Rare", "Epic", "Legendary", "Special"];
let currentRarityIndex = 0;

const itemSelect = document.getElementById("item");
const statSelect = document.getElementById("stat");
const calcBtn = document.getElementById("calculateBtn");
const resultsTable = document.querySelector("#resultsTable tbody");
const rarityHeader = document.getElementById("rarityHeader");

const prevRarityBtn = document.getElementById("prevRarity");
const nextRarityBtn = document.getElementById("nextRarity");
const currentRarityLabel = document.getElementById("currentRarity");

itemSelect.addEventListener("change", updateStatOptions);
statSelect.addEventListener("change", () => {
  calcBtn.disabled = !statSelect.value;
});
calcBtn.addEventListener("click", () => renderTable(rarities[currentRarityIndex]));

prevRarityBtn.addEventListener("click", () => {
  if (currentRarityIndex > 0) {
    currentRarityIndex--;
    updateRarity();
  }
});

nextRarityBtn.addEventListener("click", () => {
  if (currentRarityIndex < rarities.length - 1) {
    currentRarityIndex++;
    updateRarity();
  }
});

function updateRarity() {
  currentRarityLabel.textContent = rarities[currentRarityIndex];
 // rarityHeader.textContent = rarities[currentRarityIndex];
  renderTable(rarities[currentRarityIndex]);
  prevRarityBtn.disabled = currentRarityIndex === 0;
  nextRarityBtn.disabled = currentRarityIndex === rarities.length - 1;
}

function updateStatOptions() {
  const item = itemSelect.value;
  statSelect.innerHTML = '<option value="" disabled selected hidden>No stat selected</option>';
  statSelect.disabled = true;
  calcBtn.disabled = true;
  if (!item || typeof reforges === "undefined") return;

  const validReforges = reforges.filter(r => r.itemTypes.includes(item));
  const statSet = new Set();

  validReforges.forEach(r => {
    rarities.forEach(rarity => {
      const stats = r.stats[rarity] || {};
      Object.keys(stats).forEach(stat => statSet.add(stat));
    });
  });

  Array.from(statSet).sort().forEach(stat => {
    const option = document.createElement("option");
    option.value = stat;
    option.textContent = stat;
    statSelect.appendChild(option);
  });

  statSelect.disabled = statSet.size === 0;
}

function toggleInfo(el) {
  const popup = el.nextElementSibling;
  popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
}

function renderTable(rarity) {
  const item = itemSelect.value;
  const stat = statSelect.value;
  if (!item || !stat) return;
  
  const statHeader = document.getElementById("statHeader");
  statHeader.textContent = stat || "Stat";

  const validReforges = reforges.filter(r => r.itemTypes.includes(item));
  const filtered = validReforges.filter(r => (r.stats[rarity] || {})[stat] !== undefined);

  const ranked = [...filtered].sort((a, b) => {
    const aVal = a.stats[rarity]?.[stat] || 0;
    const bVal = b.stats[rarity]?.[stat] || 0;
    return bVal - aVal;
  });

  resultsTable.innerHTML = "";

  ranked.forEach((reforge, i) => {
    const allStats = reforge.stats[rarity] || {}; 
    const statsList = Object.entries(allStats)
                            .map(([key, value]) => `${key}: ${value}`)
                            .join('<br>');

    const row = document.createElement("tr");
row.innerHTML = `
  <td>${i + 1}</td>
  <td>
    <div class="reforge-name-wrapper">
      ${reforge.name}
      <span class="info-icon">ùöí
        <div class="info-popup"><b>All Stats</b><br><hr>${statsList}</div>
      </span>
    </div>
  </td>
  <td>${reforge.stats[rarity]?.[stat] || "-"}</td>
`;
    resultsTable.appendChild(row);
  });
}

updateRarity();
</script></body>
</html>
