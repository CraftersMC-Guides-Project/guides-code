<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - CraftersMC Guides</title>
  <style>
    body {
      background: url("../Backgrounds/IMG_4500.jpeg");
      background-size: cover;
      background-position-x: center;
      background-repeat: no-repeat;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      background-color: #1c1c1c99;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px #000;
      width: 60%;
      display: flex;
      flex-direction: column;
      align-items: center;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-container {
      display: flex;
      flex-direction: column;
      width: 80%;
    }
    .discord-login-button {
      background-color: #5865f2;
      color: white;
      border: none;
      padding: 15px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
      text-decoration: none;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .discord-login-button svg {
      height: 20px;
      margin-right: 10px;
    }
    .message {
      margin-top: 10px;
      text-align: center;
      font-size: 14px;
      color: #bbb;
    }
    hr {
      border: 0;
      height: 1px;
      background: #333;
      margin: 20px 0;
      width: 80%;
    }
    .other-options {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #bbb;
    }
    .other-options a {
      color: #007bff;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Login</h2>
  <div class="button-container">
    <a href="YOUR_DISCORD_AUTH_URL" class="discord-login-button">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M19.69 16.64C16.86 16.64 14.64 14.42 14.64 11.59C14.64 8.76 16.86 6.54 19.69 6.54C22.52 6.54 24.74 8.76 24.74 11.59C24.74 14.42 22.52 16.64 19.69 16.64ZM5.02 16.64C2.19 16.64 -0.03 14.42 -0.03 11.59C-0.03 8.76 2.19 6.54 5.02 6.54C7.85 6.54 10.07 8.76 10.07 11.59C10.07 14.42 7.85 16.64 5.02 16.64ZM17.35 13.46C16.74 13.46 16.16 13.17 15.76 12.72C15.76 12.72 13.36 12.72 12.76 12.72C12.16 12.72 11.58 13.17 11.18 13.46C10.58 13.81 9.85 13.81 9.25 13.46C8.65 13.17 8.07 12.72 8.07 12.72C7.47 12.72 5.07 12.72 4.47 12.72C4.07 13.17 3.49 13.46 2.89 13.46C2.29 13.46 1.71 13.17 1.31 12.72C1.31 12.72 0.31 12.72 0.01 12.72C0.01 12.72 -0.29 12.12 0.31 11.67C0.91 11.07 1.71 10.72 2.64 10.72C2.64 10.72 4.94 10.72 5.54 10.72C6.14 10.72 6.72 10.37 7.12 9.92C7.12 9.92 9.52 9.92 10.12 9.92C10.72 9.92 11.3 10.37 11.7 10.72C12.63 10.72 14.93 10.72 15.53 10.72C16.13 10.72 16.71 10.37 17.11 9.92C17.11 9.92 19.51 9.92 20.11 9.92C20.71 9.92 21.51 10.37 21.91 10.72C22.84 10.72 23.64 11.07 24.24 11.67C24.84 12.12 24.54 12.72 24.54 12.72C24.14 13.17 23.56 13.46 22.96 13.46C22.36 13.46 19.96 13.46 19.36 13.46C18.76 13.46 18.18 13.17 17.78 12.72C17.78 12.72 15.38 12.72 14.78 12.72C14.18 12.72 13.6 13.17 13.2 13.46C12.6 13.81 11.87 13.81 11.27 13.46C10.67 13.17 10.09 12.72 10.09 12.72C9.49 12.72 7.09 12.72 6.49 12.72C5.89 12.72 5.31 13.17 4.91 13.46C4.31 13.81 3.58 13.81 2.98 13.46C2.38 13.17 1.8 12.72 1.8 12.72C1.2 12.72 -1.2 12.72 0.8 12.72C1.4 13.17 1.98 13.46 2.58 13.46C3.18 13.46 5.58 13.46 6.18 13.46C6.78 13.46 7.36 13.17 7.76 12.72C7.76 12.72 10.16 12.72 10.76 12.72C11.36 12.72 11.94 13.17 12.34 13.46C12.94 13.81 13.67 13.81 14.27 13.46C14.87 13.17 15.45 12.72 15.45 12.72C16.05 12.72 18.45 12.72 19.05 12.72C19.65 12.72 20.23 13.17 20.63 13.46C21.23 13.81 21.96 13.81 22.56 13.46C23.16 13.17 23.74 12.72 23.74 12.72C23.14 12.72 20.74 12.72 20.14 12.72C19.54 12.72 18.96 13.17 18.56 13.46Z" />
      </svg>
      Login with Discord
    </a>
  </div>

  <hr>

  <div class="other-options">
    <span>Don't have a Discord account? <a href="https://discord.com/register" target="_blank">Sign up on Discord</a></span>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const code = urlParams.get('code');

    if (code) {
      fetch(`https://discord-auth.roumakdatta.workers.dev/?code=${encodeURIComponent(code)}`)
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.error) {
            console.error('Error connecting Discord:', data.error);
            // Optionally display an error message to the user
            const messageDiv = document.querySelector('.message');
            if (messageDiv) {
              messageDiv.textContent = `Discord Login Failed: ${data.error}`;
            }
          } else if (data.username) {
            console.log('Connected Discord user:', data);
            // Store relevant user information in local storage
            localStorage.setItem('discordUser', JSON.stringify({
              username: data.username,
              // You can store other relevant information from the 'data' object here
            }));
            // Redirect to your homepage or another appropriate page
            window.location.href = 'dev.html'; // Replace with your desired redirect URL
          } else {
            console.log('Discord login successful, but no username received:', data);
            // Handle cases where the username might not be directly available
            // You might want to redirect or show a generic success message
            localStorage.setItem('discordAuth', JSON.stringify(data)); // Store the entire data object
            window.location.href = 'dev.html'; // Replace with your desired redirect URL
          }
        })
        .catch(error => {
          console.error('Network error during Discord login:', error);
          // Optionally display a network error message to the user
          const messageDiv = document.querySelector('.message');
          if (messageDiv) {
            messageDiv.textContent = 'Network error during login. Please try again.';
          }
        });
    }
    // If no 'code' is present in the URL, the user needs to initiate the Discord login
    // by clicking the "Login with Discord" button.
  });

  // Replace 'YOUR_DISCORD_AUTH_URL' with the actual authorization URL you get from your Discord application.
  // This URL will typically look something like:
  // "https://discord.com/oauth2/authorize?client_id=YOUR_CLIENT_ID&redirect_uri=YOUR_REDIRECT_URI&response_type=code&scope=identify"
</script>

</body>
</html>
