<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="icon" href="assets/cmc-icon.png" type="image/png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Market Prices - CraftersMC Guides</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <script src="js/script.js"></script>
  <style>
    .profile-card {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 1001;
      display: none;
      align-items: center;
      gap: 15px;
      background: linear-gradient(135deg, rgba(40, 40, 40, 0.7), rgba(25, 25, 25, 0.8));
      backdrop-filter: blur(10px);
      padding: 12px 20px;
      border-radius: 50px;
      color: white;
      text-decoration: none;
      transition: background-color .3s, transform .3s, box-shadow .3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, .15);
      animation: fade-in-down .5s ease-out forwards;
      min-width: 200px
    }

    .profile-card:hover {
      background-color: rgba(0, 0, 0, .8);
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 20px rgba(0, 0, 0, .4)
    }

    #user-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, .2);
      transition: box-shadow .3s
    }

    #user-details {
      text-align: left
    }

    #user-name {
      font-size: 18px;
      font-weight: 700;
      line-height: 1.2
    }

    #user-tag {
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      opacity: .9;
      margin-top: 3px;
      display: block;
      letter-spacing: .5px
    }

    .profile-card.role-dev #user-avatar {
      box-shadow: 0 0 15px rgba(213, 0, 0, .8)
    }

    .profile-card.role-manager #user-avatar {
      box-shadow: 0 0 15px rgba(255, 193, 7, .8)
    }

    .profile-card.role-data-manager #user-avatar {
      box-shadow: 0 0 15px rgba(41, 98, 255, .8)
    }

    .profile-card.role-rank-seller #user-avatar {
      box-shadow: 0 0 15px rgba(0, 200, 83, .8)
    }

    @keyframes fade-in-down {
      from {
        opacity: 0;
        transform: translateY(-10px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    @media (max-width:768px) {
      .profile-card {
        top: 65px;
        right: 10px;
        padding: 8px 14px;
        gap: 12px;
        min-width: 0
      }

      #user-avatar {
        width: 40px;
        height: 40px
      }

      #user-name {
        font-size: 16px
      }

      #user-tag {
        font-size: 10px
      }
    }

    .private-item-highlight {
      border: 2px dashed #ff9800;
      background-color: rgba(255, 152, 0, .1);
      padding: 5px;
      border-radius: 8px;
      margin-bottom: 8px;
      text-align: center;
      font-weight: 700;
      color: #ff9800
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      justify-items: center;
      margin: 20px
    }

    .result {
      background: rgba(30, 30, 30, .85);
      padding: 12px;
      border-radius: 8px;
      width: 100%;
      max-width: 350px;
      cursor: pointer;
      transition: transform .2s;
      color: #fff
    }

    .result:hover {
      transform: scale(1.02)
    }

    .market-info-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      margin-bottom: 6px;
      gap: 8px
    }

    .market-info-head img {
      width: 40px;
      height: 40px;
      image-rendering: pixelated
    }

    .market-result-div-info {
      font-size: 14px;
      margin: 2px 0
    }

    .market-coin {
      width: 1em;
      height: 1em;
      vertical-align: middle;
      margin-left: 4px
    }

    .market-description {
      font-size: 13px;
      margin-top: 6px;
      color: #ccc
    }

    .rarity-tag {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 700;
      margin-bottom: 5px
    }

    .rarity-legendary {
      background-color: #ff9800;
      color: #000
    }

    .rarity-epic {
      background-color: #9c27b0;
      color: #fff
    }

    .rarity-rare {
      background-color: #2196f3;
      color: #fff
    }

    .rarity-uncommon {
      background-color: #4caf50;
      color: #fff
    }

    .rarity-common {
      background-color: #9e9e9e;
      color: #fff
    }
  </style>
</head>

<body>
  <div id="loader">
    <div></div>
    <div></div>
    <div></div>
  </div>
  <div class="market-background"></div>
  <a href="/profile.html" class="profile-card" id="profile-card">
    <img id="user-avatar" src="https://placehold.co/110x110/dddddd/333333?text=...&font=inter" alt="User Avatar" />
    <div id="user-details">
      <div id="user-name">Loading...</div>
      <div id="user-tag"></div>
    </div>
  </a>
  <div class="top"></div>
  <div class="sidebar" id="sidebar"></div>
  <div id="sidebar-overlay" onclick="toggleSidebar()"></div>
  <span class="material-icons" id="scrollToTopBtn">north</span>
  <div class="gap"></div>
  <h1 class="market-title">CraftersMC Market Prices</h1>
  <input type="text" id="searchBox" placeholder="Search Items..." oninput="searchItems()" />
  <div class="market-boxy-box">
    <div id="results" class="results-grid"></div>
  </div>
  <div class="market-categories">Discover the prices</div>
  <div class="market-divider"></div>
  <div class="market-category-section">
    <div class="market-category-grid">
      <div class="market-category-item" onclick="goToCategory('farming')">
        <img src="assets/ui-icons/ui_bazaar_category_farming_active.png" alt="farming" class="market-bz">
        <div class="market-category-name">
          <p>Farming</p>
        </div>
      </div>
      <div class="market-category-item" onclick="goToCategory('mining')">
        <img src="assets/ui-icons/ui_bazaar_category_mining_active.png" alt="mining" class="market-bz">
        <div class="market-category-name">
          <p>Mining</p>
        </div>
      </div>
      <div class="market-category-item" onclick="goToCategory('combat')">
        <img src="assets/ui-icons/ui_bazaar_category_combat_active.png" alt="Combat" class="market-bz">
        <div class="market-category-name">
          <p>Combat</p>
        </div>
      </div>
      <div class="market-category-item" onclick="goToCategory('foraging')">
        <img src="assets/ui-icons/ui_bazaar_category_foraging_active.png" alt="foraging" class="market-bz">
        <div class="market-category-name">
          <p>Foraging</p>
        </div>
      </div>
      <div class="market-category-item" onclick="goToCategory('special')">
        <img src="assets/ui-icons/ui_star_active.png" alt="special" class="market-bz">
        <div class="market-category-name">
          <p>Special</p>
        </div>
      </div>
      <div class="market-category-item" onclick="goToCategory('slayer')">
        <img src="img/Atoned_Heart.webp" alt="special" class="market-bz">
        <div class="market-category-name">
          <p>Slayer</p>
        </div>
      </div>
      <div class="market-category-item" onclick="window.location.href='pets-cat.html'">
        <img src="img/pets/Phoenix_Pet.webp" alt="Pets">
        <div class="market-category-name">
          <p>Pets</p>
        </div>
      </div>
    </div>
  </div>
  <div id="footer"></div>
  <script>
    function getCookie(name) { const value = `; ${document.cookie}`; const parts = value.split(`; ${name}=`); if (parts.length === 2) return decodeURIComponent(parts.pop().split(';').shift()); return '' }
    async function loadUserInfo() { const profileCard = document.getElementById('profile-card'); const defaultAvatar = "https://placehold.co/110x110/dddddd/333333?text=...&font=inter"; const avatarEl = document.getElementById('user-avatar'); const nameEl = document.getElementById('user-name'); const tagEl = document.getElementById('user-tag'); try { const storedUserCookie = getCookie('discordUser'); if (!storedUserCookie) { profileCard.style.display = 'none'; return } const loggedInUser = JSON.parse(storedUserCookie); const userId = loggedInUser.id; if (!userId) { profileCard.style.display = 'none'; return } const response = await fetch(`https://discord-auth.roumakdatta.workers.dev/users/${userId}`); if (!response.ok) { profileCard.style.display = 'none'; return } const user = await response.json(); profileCard.style.display = 'flex'; const avatarUrl = user.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png` : defaultAvatar; avatarEl.src = avatarUrl; avatarEl.onerror = () => { avatarEl.src = defaultAvatar }; nameEl.textContent = user.global_name || user.username || 'Unknown User'; const roleColors = { dev: '#d50000', manager: '#ffc107', "data manager": '#2962ff', "rank seller": '#00c853' }; const userRole = user.role ? user.role.toLowerCase() : ''; profileCard.classList.remove('role-dev', 'role-manager', 'role-data-manager', 'role-rank-seller'); if (userRole && userRole !== 'normal user') { const roleClass = userRole.replace(' ', '-'); profileCard.classList.add(`role-${roleClass}`) } if (roleColors[userRole]) { tagEl.textContent = user.role.toUpperCase(); tagEl.style.color = roleColors[userRole] } else { tagEl.textContent = ''; tagEl.style.color = '' } } catch (err) { console.error('Error in loadUserInfo:', err); profileCard.style.display = 'none' } }
    document.addEventListener('DOMContentLoaded', () => { loadUserInfo(); loadItems() });
    let items = [], prices = {}, pets = [], petPrices = {}, minions = [], minionPrices = {}, isDataLoaded = false, isDevUser = false;
    function goToCategory(categoryName) { window.location.href = `categories?cat=${categoryName}` }
    function parsePrices(text) { const priceMap = {}; const lines = text.trim().split('\n'); for (const line of lines) { const parts = line.split(':'); if (parts.length < 2) continue; const id = parts[0].trim(); const arrayStr = parts.slice(1).join(':').trim(); try { const parsed = JSON.parse(arrayStr); if (Array.isArray(parsed) && parsed.length >= 2) { priceMap[id] = parsed[1] } } catch (e) { } } return priceMap }
    async function loadItems() { try { const [marketRes, priceRes, petRes, petPriceRes, minionRes, minionPriceRes] = await Promise.all([fetch('market/market.txt'), fetch('market/mprices.txt'), fetch('market/pets.txt'), fetch('market/pet-prices.txt'), fetch('market/minions.txt'), fetch('market/minion-prices.json')]); items = await marketRes.json(); prices = parsePrices(await priceRes.text()); pets = await petRes.json(); petPrices = await petPriceRes.json(); minions = await minionRes.json(); minionPrices = await minionPriceRes.json(); isDataLoaded = true; searchItems() } catch (error) { console.error("Error loading data:", error); document.getElementById('results').innerHTML = '<p>Failed to load item data.</p>' } finally { document.getElementById('loader').style.display = 'none' } }
    function getRarityTag(rarity) { if (!rarity) return ''; const r = rarity.toLowerCase(); if (r === 'legendary') return '<span class="rarity-tag rarity-legendary">LEGENDARY</span>'; if (r === 'epic') return '<span class="rarity-tag rarity-epic">EPIC</span>'; if (r === 'rare') return '<span class="rarity-tag rarity-rare">RARE</span>'; if (r === 'uncommon') return '<span class="rarity-tag rarity-uncommon">UNCOMMON</span>'; if (r === 'common') return '<span class="rarity-tag rarity-common">COMMON</span>'; return '' }
    function imgOf(o) { return o.picture || o.img || o.image || o.icon || 'assets/placeholder.png' }
    function coinIcon() { return 'img/coin.png' }
    function searchItems() { const query = document.getElementById('searchBox').value.toLowerCase(); const resultsDiv = document.getElementById('results'); resultsDiv.innerHTML = ''; if (!isDataLoaded) { resultsDiv.innerHTML = '<p>Loading items...</p>'; return } const filteredItems = items.filter(item => { const isPublic = item.hasOwnProperty("public") ? item.public : true; return (isPublic || isDevUser) && item.name.toLowerCase().includes(query) }); const filteredPets = pets.filter(pet => pet.name.toLowerCase().includes(query)); const filteredMinions = minions.filter(minion => minion.name.toLowerCase().includes(query)); if (filteredItems.length === 0 && filteredPets.length === 0 && filteredMinions.length === 0 && query.trim() !== '') { resultsDiv.innerHTML = '<p>No results found.</p>'; return } if (query.trim() === '') return; filteredItems.slice(0, 10).forEach(item => { const price = prices[item.id] || 'N/A'; const div = document.createElement('div'); div.className = 'result'; const isPublic = item.hasOwnProperty("public") ? item.public : true; let privateHighlight = (!isPublic && isDevUser) ? `<div class='private-item-highlight'>PRIVATE ITEM</div>` : ''; div.innerHTML = `${privateHighlight}<div class="market-info-head"><img src="${imgOf(item)}" alt="${item.name}" /><span>${item.name}</span><span>${price} <img src="${coinIcon()}" class="market-coin"/></span></div><div class="market-description">${item.description || ''}</div>${getRarityTag(item.rarity)}`; resultsDiv.appendChild(div) }); filteredPets.slice(0, 10).forEach(pet => { const price = petPrices[pet.id] || 'N/A'; const div = document.createElement('div'); div.className = 'result'; div.innerHTML = `<div class="market-info-head"><img src="${imgOf(pet)}" alt="${pet.name}" /><span>${pet.name}</span><span>${price} <img src="${coinIcon()}" class="market-coin"/></span></div><div class="market-description">${pet.description || ''}</div>${getRarityTag(pet.rarity)}`; resultsDiv.appendChild(div) }); filteredMinions.slice(0, 10).forEach(minion => { const price = minionPrices[minion.id] || 'N/A'; const div = document.createElement('div'); div.className = 'result'; div.innerHTML = `<div class="market-info-head"><img src="${imgOf(minion)}" alt="${minion.name}" /><span>${minion.name}</span><span>${price} <img src="${coinIcon()}" class="market-coin"/></span></div><div class="market-description">${minion.description || ''}</div>${getRarityTag(minion.rarity)}`; resultsDiv.appendChild(div) }) }
    document.addEventListener('keydown', function (e) { const searchBox = document.getElementById('searchBox'); if (document.activeElement !== searchBox) { searchBox.focus(); searchBox.value = '' } });
  </script>
</body>

</html>