<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Items</title>
    <style>
        @font-face {
            font-family: 'MinecraftTen';
            src: url('https://craftersmc.opendevsflow.xyz/src/font.woff2') format('woff2');
        }
        body { max-width:100%; font-family: Arial, sans-serif; text-align: center; background-color: #1a1a1a; color: white; margin: 0; padding:0;}
        #searchBox { width: 80%; padding: 10px; margin: 20px; border: 0px solid white; font-size: 16px; background-color: black; }
        .result { display: flex; align-items: center; border: 1px solid #444; padding: 10px; margin: 10px auto; cursor: pointer; text-align: left; background-color: #0a0a2a; border-radius: 8px; max-width: 600px; }
        .result img { width: 100px; height: 100px; margin-right: 15px; border-radius: 5px; }
        .result .info { flex: 1; }
        #head { display:flex; width:100%; height:80%; background:#00a3cc;}
        #logo { position:absolute; overflow:hidden;}
        #logo img { width:100%; height:50px; justify-content:center; margin-top:12.5%;}
        #cmc-logo { display:flex; width : 70px; height:60px ; background-color: #008fb3; border-radius:0px 50px 0px 0px; box-shadow:0.1px 0px 40px black;}
        #cmc-bazaar { font-family: 'MinecraftTen', sans-serif; font-size:30px; color:white; display:table-cell; vertical-align:center; text-align:center; width:60%; height:40px; margin-top:5px; }
        #line-1 { width: 100% ; height: 1px ; background-color: gray;}
        .catagory { margin-top: 100px; flex-warp:warp; flex-grow:1;}
        #farming { width:30%; height: 100px; background:gray; margin-left:0px; border-radius:10px;}
        #mining { width:30%; height: 100px; background:gray; margin-left:5px; border-radius:10px ;}
        #combat { width:30%; height: 100px; background:gray; margin-left:5px ; border-radius: 10px;}
        #combat img { overflow:hidden; width:80%; height:90px; left:50%; transform:translate(0%, 0%) margin-top:10px; }
        #foraging { width:30%; height: 90px; background:gray; margin-left: 0px;border-radius:10px;}
        #miscellaneous { width:30%; height: 100px; background:gray; margin-left: 5px; border-radius:10px;}
        #flex { display:flex; margin-bottom:15px; text-align:center; justify-content:center;}
        #flex1 { display:flex; text-align:center; justify-content:center; align-item:center;}
    </style>
</head>
    
<body>
    <input type="text" id="searchBox" placeholder="Search Items..." onkeyup="searchItems()">
    <div id="results"></div>
    <div id="line-1"></div>
    <div class="catagory">
        <div id="flex">
            <div id="farming">farming</div>
            <div id="mining">mining</div>
            <div id="combat"><img src="img/Golden_Sword_JE3_BE2.png"></div>
        </div>
        <div id="flex1">
            <div id="foraging">foraging</div>
            <div id="miscellaneous">mis</div>
        </div>
    </div>

    <script>
        let items = [];

        // Error handling for loading items
        async function loadItems() {
            try {
                const response = await fetch('market/market.txt');
                if (!response.ok) {
                    throw new Error('Failed to fetch items.txt');
                }
                const text = await response.text();
                items = JSON.parse(text);
            } catch (error) {
                console.error('Error loading items:', error);
                alert('Failed to load items data');
            }
        }

        // Searching for items by name
        function searchItems() {
            const query = document.getElementById('searchBox').value.toLowerCase();
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            // Filter and display the matching items
            const filteredItems = items.filter(item => item.name.toLowerCase().includes(query));

            if (filteredItems.length === 0) {
                resultsDiv.innerHTML = '<p>No items found</p>';
            } else {
                filteredItems.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'result';
                    div.innerHTML = `
                        <img src="${item.picture}" alt="${item.name}">
                        <div class="info">
                            <b>${item.name}</b> (ID: ${item.id})
                        </div>`;
                    div.onclick = () => window.location.href = item.url;
                    resultsDiv.appendChild(div);
                });
            }
        }

        // Load items when the page is ready
        loadItems();
    </script>
</body>
</html>

