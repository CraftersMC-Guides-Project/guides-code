<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Market Prices - CraftersMC Guides</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="css/essential.css" />
  <link rel="stylesheet" href="css/market.css" />
  <script src="js/script.js"></script>
  <script src="js/market.js"></script>
</head>

<body>
  <div id="loader"><div></div><div></div><div></div></div>
  <div class="navbar"></div>
  <div class="sidebar" id="sidebar"></div>
  <div id="sidebar-overlay"></div>
  <button id="scrollToTopBtn"><span class="material-icons">north</span></button>

  <br><br>
  <h1>‎ </h1>
  <h1>‎ </h1>

  <input type="text" id="searchBox" placeholder="Search Items..." onkeyup="searchItems()" disabled />
  <div id="results"></div>

  <div class="categories">Categories</div>
  <div class="divider"></div>

  <div class="category-section">
    <div class="category-grid">
      <div class="category-item" onclick="goToCategory('farming')">
        <img src="assets/ui-icons/ui_bazaar_category_farming_active.png" alt="farming" />
        <div class="category-name"><p>Farming</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('mining')">
        <img src="assets/ui-icons/ui_bazaar_category_mining_active.png" alt="mining" />
        <div class="category-name"><p>Mining</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('combat')">
        <img src="assets/ui-icons/ui_bazaar_category_combat_active.png" alt="Combat" />
        <div class="category-name"><p>Combat</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('foraging')">
        <img src="assets/ui-icons/ui_bazaar_category_foraging_active.png" alt="foraging" />
        <div class="category-name"><p>Foraging</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('miscellaneous')">
        <img src="assets/ui-icons/ui_bazaar_category_oddities_active.png" alt="miscellaneous" />
        <div class="category-name"><p>Miscellaneous</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('special')">
        <img src="assets/ui-icons/ui_star_active.png" alt="special" />
        <div class="category-name"><p>Special</p></div>
      </div>
    </div>
  </div>

  <div id="footer"></div>

  <script>
    let items = [];

    async function loadItems() {
      const response = await fetch('../market/market.txt');
      const text = await response.text();

      // Assuming market.txt has lines like: id|name|picture
      items = text
        .trim()
        .split('\n')
        .map(line => {
          const [id, name, picture] = line.split('|');
          return { id, name, picture };
        });

      document.getElementById('searchBox').disabled = false;
    }

    function searchItems() {
      const query = document.getElementById('searchBox').value.toLowerCase();
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      const filteredItems = items.filter(item => item.name.toLowerCase().includes(query));

      if (filteredItems.length === 0) {
        resultsDiv.innerHTML = '<p>No results found.</p>';
        return;
      }

      filteredItems.forEach(item => {
        const div = document.createElement('div');
        div.className = 'result';
        div.innerHTML = `
          <img src="${item.picture}" alt="${item.name}">
          <div class="info">
            <b>${item.name}</b>
            <span>ID: ${item.id}</span>
          </div>`;
        div.onclick = () => {
          window.location.href = `item.html?item=${item.id}`;
        };
        resultsDiv.appendChild(div);
      });
    }

    function goToCategory(category) {
      window.location.href = `categories.html?cat=${category}`;
    }

    loadItems();
  </script>
</body>

</html>
