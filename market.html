<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Market Prices - CraftersMC Guides</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="css/essential.css" />
  <link rel="stylesheet" href="css/market.css" />
  <script src="js/script.js" defer></script>
</head>

<body>
  <div id="loader"><div></div><div></div><div></div></div>
  <div class="navbar"></div>
  <div class="sidebar" id="sidebar"></div>
  <div id="sidebar-overlay"></div>
  <button id="scrollToTopBtn"><span class="material-icons">north</span></button>

  <div style="margin-top: 80px;"></div>

  <div class="search-container">
    <input type="text" id="searchBox" placeholder="Search Items..." onkeyup="searchItems()" disabled />
    <div id="results" class="results-box"></div>
  </div>

  <h2 class="categories">Categories</h2>
  <div class="divider"></div>

  <div class="category-section">
    <div class="category-grid">
      <div class="category-item" onclick="goToCategory('farming')">
        <img src="assets/ui-icons/ui_bazaar_category_farming_active.png" alt="farming" />
        <div class="category-name"><p>Farming</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('mining')">
        <img src="assets/ui-icons/ui_bazaar_category_mining_active.png" alt="mining" />
        <div class="category-name"><p>Mining</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('combat')">
        <img src="assets/ui-icons/ui_bazaar_category_combat_active.png" alt="combat" />
        <div class="category-name"><p>Combat</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('foraging')">
        <img src="assets/ui-icons/ui_bazaar_category_foraging_active.png" alt="foraging" />
        <div class="category-name"><p>Foraging</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('miscellaneous')">
        <img src="assets/ui-icons/ui_bazaar_category_oddities_active.png" alt="miscellaneous" />
        <div class="category-name"><p>Miscellaneous</p></div>
      </div>
      <div class="category-item" onclick="goToCategory('special')">
        <img src="assets/ui-icons/ui_star_active.png" alt="special" />
        <div class="category-name"><p>Special</p></div>
      </div>
    </div>
  </div>

  <div id="footer"></div>

  <script>
    let items = [];

    async function loadItems() {
      try {
        const response = await fetch('market/market.txt');
        const text = await response.text();
        items = text.trim().split('\n').map(line => {
          const [id, name, picture] = line.split('|');
          return { id, name, picture };
        });
        document.getElementById('searchBox').disabled = false;
      } catch (e) {
        console.error('Failed to load items:', e);
        document.getElementById('results').innerHTML = '<p>Error loading items.</p>';
      }
    }

    function searchItems() {
      const query = document.getElementById('searchBox').value.toLowerCase();
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (!query) return;

      const matched = items.filter(item => item.name.toLowerCase().includes(query));
      if (matched.length === 0) {
        resultsDiv.innerHTML = '<p>No results found.</p>';
        return;
      }

      matched.forEach(item => {
        const div = document.createElement('div');
        div.className = 'result';
        div.innerHTML = `
          <img src="${item.picture}" alt="${item.name}">
          <div class="info">
            <b>${item.name}</b>
            <span>ID: ${item.id}</span>
          </div>
        `;
        div.onclick = () => window.location.href = `item.html?item=${item.id}`;
        resultsDiv.appendChild(div);
      });
    }

    function goToCategory(category) {
      window.location.href = `categories.html?cat=${category}`;
    }

    loadItems();
  </script>

  <style>
    .search-container {
      max-width: 600px;
      margin: 20px auto;
      position: relative;
      padding: 0 10px;
    }

    #searchBox {
      width: 100%;
      padding: 12px 15px;
      font-size: 16px;
      border: 1px solid #444;
      border-radius: 6px;
      background: #1f1f1f;
      color: #fff;
    }

    .results-box {
      margin-top: 10px;
    }

    .result {
      display: flex;
      align-items: center;
      background: #2a2a2a;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .result:hover {
      background: #333;
    }

    .result img {
      height: 40px;
      width: 40px;
      margin-right: 10px;
    }

    .info b {
      color: #fff;
      display: block;
    }

    .info span {
      font-size: 12px;
      color: #aaa;
    }
  </style>
</body>
    </html>
    
